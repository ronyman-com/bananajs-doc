<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="icon" href="/assets/images/favicon.ico" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
  
  <!-- BananaJS Meta Tags -->
  <meta name="google-adsense-account" content="ca-pub-1930350912157340">
  <meta property="og:title" content="BananaJS - The JavaScript Framework tool-kit most work on the last modern app" />
  <meta property="og:url" content="https://bananajs.com" />
  <meta property="og:image" content="/assets/images/social-preview.jpg" />
  <meta property="og:site_name" content="BananaJS" />
  <meta property="og:description" content="The sweetest JavaScript framework that's ripe for development" />
  <meta property="og:url" content="https://bananajs.com">
  <meta property="og:image" content="https://scontent.fmel8-1.fna.fbcdn.net/v/t39.30808-6/492333520_1108915574587640_77671229053405046_n.jpg?_nc_cat=104&ccb=1-7&_nc_sid=127cfc&_nc_ohc=VPXeQYzE3iEQ7kNvwHazxv8&_nc_oc=AdnjXnPkhl63Qs1diN6TcGD_Ehzc6Fl5mbHlFP-Ox1WsWi33rK15u81BC1A8meG43clUvTbTAtqc2iFRMTl0rzhZ&_nc_zt=23&_nc_ht=scontent.fmel8-1.fna&_nc_gid=ev8-gCPPmvXF32SnvCy_FQ&oh=00_AfH0vp5J2xpde9_QGbOiSOSwDMWDuT4wFjWtkiG_Du0KQw&oe=680B6274">
  <meta name="twitter:card" content="summary_large_image">
  
  <!-- Preload critical resources -->
  <link rel="preload" href="/assets/css/theme.css" as="style">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
  
  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/theme.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-buttons/2.21.0/buttons.min.css">
   <!-- Prism.js JavaScript -->
   <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
  
  <title>BananaJS | The modern JavaScript Framework kit.</title>
  
  <style>
    :root {
      --banana-yellow: #FFE135;
      --banana-dark: #FBCB1A;
      --banana-darker: #E6B800;
      --banana-text: #000000; /* Changed to black for better contrast */
      --banana-light: #FFF5CC;
      --banana-white: #FFFDF5;
      --banana-orange: #141313; /* Added orange accent color */
      --mobile-breakpoint: 768px;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Inter', 'Comic Neue', system-ui, sans-serif;
      background-color: var(--banana-white);
      color: var(--banana-text);
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    
    /* Improved Navbar */
    .navbar {
      background-color: var(--banana-yellow);
      padding: 0.75rem 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      border-bottom: 3px solid var(--banana-darker);
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    
    .navbar-brand {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-weight: 700;
      font-size: 1.25rem;
      color: var(--banana-text); /* Ensure text is black */
    }
    
    .navbar-brand img {
      height: 36px;
      width: auto;
    }
    
    #version-display {
      background-color: var(--banana-orange);
      color: white;
      padding: 0.15rem 0.4rem;
      border-radius: 12px;
      font-size: 0.7rem;
      margin-left: 0.3rem;
    }
    
    .external-links a {
      background-color: var(--banana-darker);
      color: white;
      padding: 0.4rem 0.8rem;
      border-radius: 4px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.2s ease;
      font-size: 0.9rem;
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
    }
    
    .external-links a:hover {
      background-color: var(--banana-text);
      color: white;
      transform: translateY(-1px);
    }
    
    .mobile-sidebar-toggle {
      display: none;
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--banana-text);
      padding: 0.5rem;
    }
    
    /* Enhanced Sidebar */
    .sidebar {
      width: 260px;
      background-color: var(--banana-light);
      height: calc(100vh - 60px);
      position: fixed;
      left: 0;
      top: 60px;
      padding: 1rem;
      border-right: 2px dashed var(--banana-dark);
      overflow-y: auto;
      transition: transform 0.3s ease;
      z-index: 900;
    }
    
    .sidebar nav ul {
      list-style: none;
    }
    
    .sidebar nav a {
      display: block;
      padding: 0.5rem 0.75rem;
      color: var(--banana-text);
      text-decoration: none;
      border-radius: 4px;
      transition: all 0.2s ease;
      margin: 0.15rem 0;
      font-size: 0.95rem;
    }
    
    .sidebar nav a:hover, 
    .sidebar nav a.active {
      background-color: var(--banana-yellow);
      font-weight: 500;
    }
    
    .folder summary {
      cursor: pointer;
      font-weight: 600;
      padding: 0.5rem 0.75rem;
      list-style: none;
      display: flex;
      align-items: center;
      transition: all 0.2s ease;
    }
    
    .folder summary:hover {
      background-color: rgba(255, 225, 53, 0.3);
    }
    
    .folder summary::-webkit-details-marker {
      display: none;
    }
    
    .folder summary::before {
      content: "+";
      display: inline-block;
      margin-right: 0.5rem;
      transition: transform 0.2s ease;
      font-weight: bold;
    }
    
    .folder[open] summary::before {
      content: "-";
    }
    
    .folder ul {
      padding-left: 1rem;
      margin: 0.25rem 0;
    }
    
    /* Mobile Sidebar */
    .mobile-sidebar {
      display: none;
      position: fixed;
      top: 60px;
      left: 0;
      width: 100%;
      max-height: calc(100vh - 60px);
      background-color: var(--banana-light);
      z-index: 1000;
      padding: 1rem;
      transform: translateY(-100%);
      transition: transform 0.3s ease;
      overflow-y: auto;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    
    .mobile-sidebar.active {
      transform: translateY(0);
    }
    
    /* Main Content */
    .content {
      margin-left: 260px;
      padding: 1.5rem;
      min-height: calc(100vh - 120px);
      flex: 1;
    }
    
    /* Feature Cards */
    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin: 2rem 0;
    }
    
    .feature-card {
      background-color: var(--banana-light);
      border-radius: 8px;
      padding: 1.5rem;
      border-left: 4px solid var(--banana-darker);
      transition: transform 0.2s ease;
    }
    
    .feature-card:hover {
      transform: translateY(-5px);
    }
    
    .feature-card h3 {
      color: var(--banana-darker);
      margin-bottom: 0.75rem;
      font-size: 1.2rem;
    }
    
    /* CTA Buttons */
    .cta-buttons {
      display: flex;
      gap: 1rem;
      margin: 2rem 0;
      flex-wrap: wrap;
    }
    
    .cta-button {
      background-color: var(--banana-darker);
      color: white;
      padding: 0.75rem 1.5rem;
      border-radius: 6px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.2s ease;
      text-align: center;
    }
    
    .cta-button:hover {
      background-color: var(--banana-text);
      transform: translateY(-2px);
    }
    
    .cta-button.secondary {
      background-color: var(--banana-light);
      color: var(--banana-text);
      border: 2px solid var(--banana-dark);
    }
    
    /* Footer */
    .footer {
      background-color: var(--banana-yellow);
      padding: 1rem;
      text-align: center;
      border-top: 3px solid var(--banana-darker);
      margin-left: 260px;
      font-size: 0.9rem;
    }
    
    .footer-content {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.75rem;
      margin: 0.75rem 0;
      flex-wrap: wrap;
    }
    
    .footer img {
      height: 24px;
    }
    
    .footer a {
      color: var(--banana-text);
      font-weight: 500;
    }
    
    /* Code blocks */
    pre {
      background-color: var(--banana-light);
      padding: 1rem;
      border-radius: 6px;
      border-left: 4px solid var(--banana-darker);
      position: relative;
      overflow-x: auto;
      margin: 1rem 0;
      font-size: 0.9rem;
    }
    
    .copy-button {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      background-color: var(--banana-darker);
      color: white;
      border: none;
      padding: 0.2rem 0.5rem;
      border-radius: 3px;
      cursor: pointer;
      font-family: inherit;
      font-size: 0.8rem;
      transition: all 0.2s ease;
    }
    
    .copy-button:hover {
      background-color: var(--banana-text);
    }
    
    /* Typography */
    h1, h2, h3, h4 {
      color: var(--banana-darker);
      margin-bottom: 1rem;
      line-height: 1.3;
    }
    
    h1 {
      font-size: 2rem;
      border-bottom: 3px dotted var(--banana-dark);
      padding-bottom: 0.5rem;
      margin: 1rem 0 1.5rem;
    }
    
    h2 {
      font-size: 1.6rem;
      margin-top: 1.5rem;
    }
    
    h3 {
      font-size: 1.3rem;
    }
    
    p {
      margin-bottom: 1rem;
    }
    
    ul, ol {
      margin-bottom: 1rem;
      padding-left: 1.5rem;
    }
    
    li {
      margin-bottom: 0.5rem;
    }
    
    /* Callout boxes */
    .banana-tip {
      background-color: var(--banana-light);
      border-left: 4px solid var(--banana-darker);
      padding: 1rem;
      margin: 1.25rem 0;
      border-radius: 0 6px 6px 0;
      font-size: 0.95rem;
    }
    
    .banana-tip::before {
      content: "🍌 Tip: ";
      font-weight: 600;
    }
    
    /* Banana Specials */
    .banana-peel {
      position: fixed;
      bottom: -30px;
      right: -30px;
      width: 150px;
      height: 150px;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M20,20 Q50,0 80,20 Q90,40 80,60 Q70,80 50,90 Q30,80 20,60 Q10,40 20,20" fill="%23FFE135" stroke="%23E6B800" stroke-width="2"/></svg>');
      background-size: contain;
      background-repeat: no-repeat;
      opacity: 0.15;
      z-index: -1;
      animation: float 8s ease-in-out infinite;
      pointer-events: none;
    }
    
    @keyframes float {
      0%, 100% { transform: translate(0, 0) rotate(0deg); }
      50% { transform: translate(-10px, -10px) rotate(3deg); }
    }
    
    /* Responsive Adjustments */
    @media (max-width: 768px) {
      .navbar {
        padding: 0.6rem 1rem;
      }
      
      .navbar-brand {
        font-size: 1.1rem;
      }
      
      .navbar-brand img {
        height: 30px;
      }
      
      .sidebar {
        display: none;
      }
      
      .content, .footer {
        margin-left: 0;
        padding: 1rem;
      }
      
      .mobile-sidebar-toggle {
        display: block;
      }
      
      h1 {
        font-size: 1.7rem;
      }
      
      h2 {
        font-size: 1.4rem;
      }
      
      .feature-grid {
        grid-template-columns: 1fr;
      }
      
      .banana-peel {
        width: 120px;
        height: 120px;
        opacity: 0.1;
      }
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <header class="navbar">
    <div class="navbar-brand">
      <img src="/assets/images/bananajs_logo.jpg" alt="BananaJS Logo" loading="lazy">
      <span>BananaJS <span id="footer-version" style="color: var(--banana-orange);">v1.0.0</span></span>
    </div>
    
    <div class="external-links">
      <a href="https://github.com/ronyman-com/bananaJS" class="github-link" target="_blank" rel="noopener noreferrer">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="vertical-align: middle;">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z"></path>
        </svg>
        GitHub
      </a>
    </div>

    <button id="mobile-sidebar-toggle" class="mobile-sidebar-toggle" aria-label="Toggle menu">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M3 12h18M3 6h18M3 18h18"></path>
      </svg>
    </button>
  </header>

 <!-- Mobile Sidebar -->
 <aside class="mobile-sidebar" id="mobile-sidebar">
  <nav>
    <ul>
      
        
          <li><a href="/index.html">Index</a></li>
        
      
        
          <li><a href="/installation.html">Install</a></li>
        
      
        
          <li><a href="/getting-started.html">Getting Started</a></li>
        
      
        
          <li><a href="/workspace.html">Workspace.</a></li>
        
      
        
          <li><a href="/build-tool.html">Build Tools.</a></li>
        
      
        
          <li><a href="/debug.html">Debug &amp; Error Assistant.</a></li>
        
      
        
          <li><a href="/cli.html">CLI</a></li>
        
      
        
          <li><a href="/ws.html">Web Socket</a></li>
        
      
        
          <li><a href="/first-app.html">Create First App</a></li>
        
      
        
          <li><a href="/api.html">API Reference.</a></li>
        
      
        
          <li><a href="/examples.html">Examples</a></li>
        
      
        
          <li><a href="/npm.html">Install From NPM</a></li>
        
      
        
          <li><a href="/hrm.html">Hot Module Replacement</a></li>
        
      
        
          <li><a href="/changelog.html">Change LOG</a></li>
        
      
    </ul>
  </nav>
</aside>

<!-- Sidebar -->
<aside class="sidebar" id="sidebar">
  <div class="sidebar-resizer" id="sidebar-resizer"></div>
  <nav>
    <ul>
      
        
          <li><a href="/index.html">Index</a></li>
        
      
        
          <li><a href="/installation.html">Install</a></li>
        
      
        
          <li><a href="/getting-started.html">Getting Started</a></li>
        
      
        
          <li><a href="/workspace.html">Workspace.</a></li>
        
      
        
          <li><a href="/build-tool.html">Build Tools.</a></li>
        
      
        
          <li><a href="/debug.html">Debug &amp; Error Assistant.</a></li>
        
      
        
          <li><a href="/cli.html">CLI</a></li>
        
      
        
          <li><a href="/ws.html">Web Socket</a></li>
        
      
        
          <li><a href="/first-app.html">Create First App</a></li>
        
      
        
          <li><a href="/api.html">API Reference.</a></li>
        
      
        
          <li><a href="/examples.html">Examples</a></li>
        
      
        
          <li><a href="/npm.html">Install From NPM</a></li>
        
      
        
          <li><a href="/hrm.html">Hot Module Replacement</a></li>
        
      
        
          <li><a href="/changelog.html">Change LOG</a></li>
        
      
    </ul>
  </nav>
</aside>

  <!-- Main Content -->
  <main class="content" id="content">
    <h1 id="hot-module-replacement-hmr-in-bananajs-🔥">Hot Module Replacement (HMR) in BananaJS 🔥</h1>
<p>BananaJS implements a powerful Hot Module Replacement system that supercharges your development workflow without requiring full page reloads.</p>
<h1 id="how-hmr-works-in-bananajs">How HMR Works in BananaJS</h1>
<p>Diagram</p>
<p>graph TD
    A[File Change] --&gt; B[BananaJS Detects Update]
    B --&gt; C[HMRServer]
    C --&gt; D[Compile Changes]
    D --&gt; E[Send Updates to Client]
    E --&gt; F[Smart Module Replacement]
    F --&gt; G[UI Updates Instantly]</p>
<h1 id="key-characteristics">Key Characteristics:</h1>
<p>State Preservation: Maintains application state during updates</p>
<p>CSS Injection: Updates styles without reloading</p>
<p>Component Hot Swapping: Replaces components while maintaining DOM state</p>
<p>Error Recovery: Falls back to full reload if HMR fails</p>
<p>Using HMR in Development
Start your dev server with HMR enabled (default):</p>
<pre><code class="language-bash">banana dev --hmr
Custom HMR Options:
bash
# Specify HMR port
banana dev --hmr --hmr-port 24678

# Disable HMR (fallback to live reload)
banana dev --no-hmr
HMR Configuration
Configure in banana.config.js:
</code></pre>
<pre><code class="language-bash">javascript
export default {
  server: {
    hmr: {
      port: 24678,       // Custom HMR port
      protocol: &#39;ws&#39;,    // &#39;ws&#39; | &#39;wss&#39;
      overlay: true,     // Show error overlays
      reload: false      // Disable auto-reload fallback
    }
  }
}
</code></pre>
<p>Framework-Specific HMR Behavior
React Components
Preserves component state</p>
<p>Supports React Fast Refresh</p>
<p>Handles hooks properly</p>
<p>Vue Components
Maintains Vuex/Pinia state</p>
<p>Preserves DOM elements</p>
<p>Supports Vue&#39;s own HMR API</p>
<p>CSS Modules
Updates styles without flash
Maintains CSSOM state
Supports PostCSS transformations
Advanced HMR Patterns
Manual HMR API</p>
<pre><code class="language-bash">javascript
if (import.meta.hot) {
  import.meta.hot.accept(&#39;./module.js&#39;, (newModule) =&gt; {
    // Custom update handler
  })
  
  import.meta.hot.dispose(() =&gt; {
    // Cleanup before module is replaced
  })
}
HMR Status Indicators
BananaJS adds these visual cues:
Blue pulse animation: Applying updates
Green checkmark: Update successful
Red error icon: Update failed (error shown)
Troubleshooting HMR
Common issues and solutions:
State Resetting Unexpectedly
</code></pre>
<pre><code class="language-bash">javascript
// banana.config.js
export default {
  server: {
    hmr: {
      preserveState: true // Force state preservation
    }
  }
}
HMR Not Working
Ensure you&#39;re not using --no-hmr flag
Check for WebSocket connectivity issues
Verify firewall isn&#39;t blocking HMR port
Slow HMR Updates
</code></pre>
<pre><code class="language-bash"># Try increasing the HMR timeout
banana dev --hmr-timeout 5000
</code></pre>
<p>Performance Optimizations
BananaJS HMR implements:</p>
<p>Differential updates (only sends changed modules)</p>
<p>Smart change detection</p>
<p>Parallel compilation</p>
<p>Cache-aware invalidation</p>
<p>Comparison with Live Reload
Feature	HMR	Live Reload
State Preserved	✅ Yes	❌ No
Update Speed	⚡ Instant	🐢 Full reload
Network Usage	Low (deltas only)	High (full assets)
Debugging	Easier	Harder
Enable HMR today for a smoother development experience! The average BananaJS developer saves 2-3 hours per week using HMR compared to full reload workflows.</p>

  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-content">
      <img src="/assets/images/logo.jpg" alt="ReadME Logo">
      <span>Documentation built with <a href="https://readme-framework.org/" target="_blank" rel="noopener noreferrer">ReadME</a></span>
    </div>
    <p>&copy; 2025 BananaJS. All rights reserved.</p>
    <p>Version: <span id="footer-version" style="color: var(--banana-orange);">v1.0.0</span> | <a href="/changelog">View Changelog</a></p>
  </footer>

  <!-- Decorative banana peel -->
  <div class="banana-peel" aria-hidden="true"></div>

  <!-- JavaScript -->
  <script>
    // Current version for cache busting
    const CURRENT_VERSION = '1743833921308';
    
    // Check for template version update
    if (localStorage.templateVersion !== CURRENT_VERSION) {
      localStorage.setItem('templateVersion', CURRENT_VERSION);
      window.location.reload(true);
    }

    // Enhanced mobile menu functionality
function setupMobileMenu() {
  const mobileToggle = document.getElementById('mobile-sidebar-toggle');
  const mobileSidebar = document.getElementById('mobile-sidebar');
  const sidebarLinks = document.querySelectorAll('.mobile-sidebar a');
  
  // Initialize mobile sidebar state
  mobileSidebar.style.display = 'none';
  mobileSidebar.style.transform = 'translateY(-100%)';
  
  function checkViewport() {
    const isMobile = window.innerWidth <= 768;
    mobileToggle.style.display = isMobile ? 'flex' : 'none';
    
    // Only manage sidebar display if we're in mobile view
    if (isMobile) {
      if (mobileSidebar.classList.contains('active')) {
        mobileSidebar.style.display = 'block';
        mobileSidebar.style.transform = 'translateY(0)';
      } else {
        mobileSidebar.style.display = 'none';
        mobileSidebar.style.transform = 'translateY(-100%)';
      }
    } else {
      // Reset for desktop view
      mobileSidebar.style.display = 'none';
      mobileSidebar.classList.remove('active');
      document.body.style.overflow = '';
    }
  }
  
  // Toggle mobile menu
  mobileToggle.addEventListener('click', (e) => {
    e.stopPropagation();
    const isOpening = !mobileSidebar.classList.contains('active');
    
    if (isOpening) {
      mobileSidebar.style.display = 'block';
      // Small timeout to allow display:block to take effect before transform
      setTimeout(() => {
        mobileSidebar.classList.add('active');
        mobileSidebar.style.transform = 'translateY(0)';
        document.body.style.overflow = 'hidden';
      }, 10);
    } else {
      mobileSidebar.style.transform = 'translateY(-100%)';
      mobileSidebar.classList.remove('active');
      document.body.style.overflow = '';
      // Delay hiding to allow animation to complete
      setTimeout(() => {
        mobileSidebar.style.display = 'none';
      }, 300);
    }
  });
  
  // Close menu when clicking outside
  document.addEventListener('click', (e) => {
    if (!mobileSidebar.contains(e.target) && e.target !== mobileToggle && 
        mobileSidebar.classList.contains('active')) {
      mobileSidebar.style.transform = 'translateY(-100%)';
      mobileSidebar.classList.remove('active');
      document.body.style.overflow = '';
      setTimeout(() => {
        mobileSidebar.style.display = 'none';
      }, 300);
    }
  });
  
  // Close menu when clicking a link
  sidebarLinks.forEach(link => {
    link.addEventListener('click', () => {
      mobileSidebar.style.transform = 'translateY(-100%)';
      mobileSidebar.classList.remove('active');
      document.body.style.overflow = '';
      setTimeout(() => {
        mobileSidebar.style.display = 'none';
      }, 300);
    });
  });
  
  // Use debounce for resize events
  let resizeTimeout;
  window.addEventListener('resize', () => {
    clearTimeout(resizeTimeout);
    resizeTimeout = setTimeout(checkViewport, 100);
  });
  
  checkViewport(); // Initial check
}
    
    // Copy code blocks functionality with fallback
    function setupCopyButtons() {
      document.querySelectorAll('pre > code').forEach(codeBlock => {
        const button = document.createElement('button');
        button.className = 'copy-button';
        button.innerHTML = '<span>Copy</span>';
        button.setAttribute('aria-label', 'Copy code to clipboard');
        
        button.addEventListener('click', () => {
          const code = codeBlock.textContent;
          
          // Modern clipboard API
          if (navigator.clipboard) {
            navigator.clipboard.writeText(code).then(() => {
              button.innerHTML = '<span>Copied! 🍌</span>';
              setTimeout(() => {
                button.innerHTML = '<span>Copy</span>';
              }, 2000);
            }).catch(err => {
              console.error('Failed to copy:', err);
              fallbackCopy(code, button);
            });
          } else {
            // Fallback for older browsers
            fallbackCopy(code, button);
          }
        });
        
        codeBlock.parentNode.insertBefore(button, codeBlock);
      });
    }
    
    // Fallback copy method
    function fallbackCopy(text, button) {
      const textarea = document.createElement('textarea');
      textarea.value = text;
      textarea.style.position = 'fixed';  // Prevent scrolling to bottom
      document.body.appendChild(textarea);
      textarea.select();
      
      try {
        const successful = document.execCommand('copy');
        if (successful) {
          button.innerHTML = '<span>Copied! 🍌</span>';
          setTimeout(() => {
            button.innerHTML = '<span>Copy</span>';
          }, 2000);
        } else {
          button.innerHTML = '<span>Press Ctrl+C</span>';
          setTimeout(() => {
            button.innerHTML = '<span>Copy</span>';
          }, 2000);
        }
      } catch (err) {
        console.error('Fallback copy failed:', err);
        button.innerHTML = '<span>Error</span>';
        setTimeout(() => {
          button.innerHTML = '<span>Copy</span>';
        }, 2000);
      }
      
      document.body.removeChild(textarea);
    }
    
    // Highlight active navigation link
    function highlightActiveLink() {
      const currentPath = window.location.pathname.split('/').pop() || 'index.html';
      const links = document.querySelectorAll('.sidebar a, .mobile-sidebar a');
      
      links.forEach(link => {
        const linkPath = link.getAttribute('href').split('/').pop();
        if (linkPath === currentPath || 
            (currentPath === '' && linkPath === 'index.html')) {
          link.classList.add('active');
        } else {
          link.classList.remove('active');
        }
      });
    }
    
    // Fetch latest version from npm
    async function fetchLatestVersion() {
      try {
        const response = await fetch('https://registry.npmjs.org/@ronyman/bananajs/latest');
        if (!response.ok) throw new Error('Version check failed');
        const data = await response.json();
        const versionElements = document.querySelectorAll('#version-display, #dynamic-version, #footer-version');
        
        versionElements.forEach(el => {
          if (el) el.textContent = `v${data.version}`;
        });
      } catch (error) {
        console.log('Using template version:', '1.0.0');
      }
    }
    
    // Initialize everything
    document.addEventListener('DOMContentLoaded', () => {
      fetchLatestVersion();
      setupMobileMenu();
      setupCopyButtons();
      highlightActiveLink();
      
      // Add animation to banana peel on mouse move
      document.addEventListener('mousemove', (e) => {
        const peel = document.querySelector('.banana-peel');
        if (peel) {
          const x = e.clientX / window.innerWidth;
          const y = e.clientY / window.innerHeight;
          peel.style.transform = `rotate(${x * 5}deg) translate(${x * 5}px, ${y * 5}px)`;
        }
      });
    });
  </script>
</body>
</html>